<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å†’æ³¡æ’åºéŠæˆ²</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #f0f0f0;
      padding: 20px;
    }
    h1 {
      color: #6c5ce7;
    }
    button {
      margin: 10px;
      padding: 10px;
      font-size: 1em;
      cursor: pointer;
    }
    .stones {
      display: flex;
      gap: 10px;
      margin: 20px 0;
    }
    .stone {
      padding: 10px 20px;
      background-color: #ffeaa7;
      border: 2px solid #fdcb6e;
      border-radius: 8px;
      cursor: pointer;
      transition: transform 0.3s ease;
    }
    .stone.selected {
      background-color: #fab1a0;
      border-color: #e17055;
      transform: scale(1.1);
    }
    .log {
      background-color: #dfe6e9;
      padding: 10px;
      border-radius: 5px;
      max-height: 200px;
      overflow-y: auto;
    }
  </style>
</head>
<body>
  <h1>ğŸª„ æ’åºéŠæˆ²ï¼ˆå†’æ³¡æ’åºï¼‰</h1>
  <button onclick="startGame()">é–‹å§‹éŠæˆ²</button>

  <div class="stones" id="stones"></div>
  <button onclick="attemptSwap()">äº¤æ›é¸å–çš„å…©å€‹</button>
  <div class="log" id="log"></div>
  <audio id="swap-sound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_5e841c4ac5.mp3?filename=click-124467.mp3"></audio>
  <audio id="complete-sound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_8d9c8f0c88.mp3?filename=success-fanfare-trumpets-6185.mp3"></audio>

  <script>
    let stones = [];
    let step = 0;
    let selectedIndices = [];

    function shuffle(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
    }

    function startGame() {
      stones = Array.from({ length: 5 }, () => Math.floor(Math.random() * 19) + 1);
      shuffle(stones);
      step = 1;
      selectedIndices = [];
      document.getElementById('log').innerHTML = '';
      log(`ğŸ® ä½¿ç”¨å†’æ³¡æ’åºï¼šæ¯æ¬¡æ¯”è¼ƒç›¸é„°çš„å…©å€‹æ•¸å­—ï¼ŒéŒ¯äº†å°±äº¤æ›ï½`);
      render();
    }

    function render() {
      const container = document.getElementById('stones');
      container.innerHTML = '';
      stones.forEach((val, index) => {
        const div = document.createElement('div');
        div.className = 'stone';
        if (selectedIndices.includes(index)) div.classList.add('selected');
        div.textContent = val;
        div.onclick = () => selectStone(index);
        container.appendChild(div);
      });
    }

    function selectStone(index) {
      if (selectedIndices.includes(index)) {
        selectedIndices = selectedIndices.filter(i => i !== index);
      } else {
        if (selectedIndices.length < 2) {
          selectedIndices.push(index);
        }
      }
      render();
    }

    function attemptSwap() {
      if (selectedIndices.length !== 2) {
        log('âš ï¸ è«‹é¸æ“‡å…©å€‹è¦äº¤æ›çš„æ•¸å­—ã€‚');
        return;
      }
      const [i, j] = selectedIndices.sort((a, b) => a - b);

      if (Math.abs(i - j) !== 1) {
        log('âš ï¸ åªèƒ½æ¯”è¼ƒç›¸é„°çš„å…©å€‹ä½ç½®å–”ï¼');
        return;
      }

      log(`ä½ é¸æ“‡äº†ï¼š${stones[i]} å’Œ ${stones[j]}`);
      if (stones[i] > stones[j]) {
        [stones[i], stones[j]] = [stones[j], stones[i]];
        log('âœ… å·²äº¤æ›ï¼');
        document.getElementById('swap-sound').play();
      } else {
        log('âœ… é †åºæ­£ç¢ºï¼Œç„¡éœ€äº¤æ›ã€‚');
      }

      selectedIndices = [];
      render();
      step++;

      if (isSorted(stones)) {
        log(`ğŸ‰ æ’å¥½äº†ï¼å¤ªæ„Ÿè¬ä½ äº†ï¼ç¸½å…±ç”¨äº† ${step} æ­¥ã€‚`);
        document.getElementById('complete-sound').play();
      }
    }

    function isSorted(arr) {
      return arr.every((val, i, a) => i === 0 || a[i - 1] <= val);
    }

    function log(message) {
      const logBox = document.getElementById('log');
      logBox.innerHTML += `<p>${message}</p>`;
      logBox.scrollTop = logBox.scrollHeight;
    }
  </script>
</body>
</html>

